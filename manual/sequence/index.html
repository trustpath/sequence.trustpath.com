<!DOCTYPE HTML>

<html>
	<head>
		<title>Sequence: High Performance Log Analyzer and Parser</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="Sequence is a high performance sequential log scanner, analyzer and parser. It sequentially goes through a log message, parses out the meaningful parts, without the use regular expressions. It can achieve high performance parsing of 100,000 - 200,000 messages per second (MPS) without the need to separate parsing rules by log source type." />
		<meta name="keywords" content="" />
		
		<script src="http://sequencer.io/js/jquery.min.js"></script>
		<script src="http://sequencer.io/js/skel.min.js"></script>
		<script src="http://sequencer.io/js/skel-layers.min.js"></script>
		<script src="http://sequencer.io/js/init.js"></script>
		
		<link rel="stylesheet" href="http://sequencer.io/css/skel.css" />
		<link rel="stylesheet" href="http://sequencer.io/css/style.css" />
		<link rel="stylesheet" href="http://sequencer.io/css/style-xlarge.css" />
		<link href="//netdna.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.css" rel="stylesheet">

		<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-681691-42', 'auto');
  ga('send', 'pageview');
   		</script>
	</head>
	
	<body id="top">
		
		<header id="header" class="skel-layers-fixed">
			<h1><a href="/">sequence</a></h1>
			<nav id="nav">
				<ul>
					
					<li><a href="/">Home</a></li>
					
					<li><a href="https://github.com/trustpath/sequence">Github</a></li>
					
					<li><a href="/manual/introduction/">Manual</a></li>
					
					<li><a href="/blog/">Blog</a></li>
					

					<li><a href="https://twitter.com/trustpath" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="https://linkedin.com/in/zhenjl" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
					</ul>
			</nav>
		</header>


		
			<section id="main" class="wrapper style1">
				<div class="container">
					<div class="row">

												<div class="3u">
							<section>
								<h3>Overview</h3>
								<ul class="alt">
								
									<li><a href="http://sequencer.io/manual/introduction/">Introduction</a> </li>
								
									<li><a href="http://sequencer.io/manual/sequence/">Sequence</a> </li>
								
									<li><a href="http://sequencer.io/manual/scanner/">Scanner</a> </li>
								
									<li><a href="http://sequencer.io/manual/analyzer/">Analyzer</a> </li>
								
									<li><a href="http://sequencer.io/manual/parser/">Parser</a> </li>
								
								</ul>
								<h3>Sequence</h3>
								<ul class="alt">
								
									<li><a href="http://sequencer.io/manual/command/">Command</a> </li>
								
									<li><a href="http://sequencer.io/manual/library/">Library</a> </li>
								
									<li><a href="http://sequencer.io/manual/patterns/">Patterns</a> </li>
								
								</ul>
								<h3>Configuration</h3>
								<ul class="alt">
								
									<li><a href="http://sequencer.io/manual/configuration/">Configuration</a> </li>
								
									<li><a href="http://sequencer.io/manual/fields/">Predefined Fields</a> </li>
								
									<li><a href="http://sequencer.io/manual/timeformats/">Time Formats</a> </li>
								
									<li><a href="http://sequencer.io/manual/tokens/">Token Types</a> </li>
								
								</ul>
							</section>
						</div>

						<div class="8u skel-cell-important">
							<section>
								<h2>Sequence</h2>

							    

<p><a href="#" class="image fit"><img src="/images/banner2.jpg" alt="" /></a></p>

<p>A new approach taken by <code>sequence</code> breaks the art of extracting meaningful information from log messages into three parts: scanning, analyzing and parsing.</p>

<p>In <code>sequence</code>, the first critical function to understanding a log message is to convert it into a sequence of valid tokens, i.e., <strong>meaningful</strong> character strings. This function is called a <em>scanner</em>, but it can be called a <em>lexical analyzer</em>, <em>lexer</em>, or <em>tokenizer</em>. The <code>sequence</code> <em>scanner</em> goes through log message sequentially while tokentizing each part of the message, without the use of regular expressions.</p>

<p>The <em>analyzer</em> takes all the <em>sequences</em> returned by the <em>scanner</em> and attempt to automatically write the parsing rules. While it&rsquo;s impossible to automatically generate 100% of the rules, the goal is to get to 75% accuracy by leveraging hints provided by analysts.</p>

<p>Finally, the <em>parser</em> will take the rules generated by the analyzer (and updated/corrected by some human) as well as the <em>sequences</em> returned by the <em>scanner</em> for log messages, and attempt to identify the matching rule. Based on the matching rule, the <em>parser</em> will tag all the recognized tokens with a semantic tag, as defined by the user.</p>

<p>The approach taken by the <em>parser</em> is a tree-based parsing approach, which is also used by <a href="http://www.liblognorm.com/">liblognorm</a>. This approach is much higher performance, as it only requires going through the log message only once. And because most, if not all, parsing rules are pre-built into a prefix tree, the engine just needs to walk through the tree once and be able to determine if there&rsquo;s a match.</p>

<p>Keep in mind that <code>sequence</code> is NOT a replacement for Splunk or ElasticSearch, or any of the log analytics solutions. It is a library and a tool that can help parse messages much faster. The result of <code>sequence</code> can be fed into these log analytics tools for further analysis.</p>

<h3 id="other-concepts:196ac21fc7c80b3643c5060d84767136">Other Concepts</h3>

<p>The <em>scanner</em> returns a <em>sequence</em>, or a list of tokens, which can then be consumed by the <em>analyzer</em> or <em>parser</em>.</p>

<p>A <em>Token</em> is a piece of information extracted from the original log message. It is a struct that contains fields for <em>TokenType</em>, <em>FieldType</em>, <em>Value</em>.</p>

<p>A <em>TokenType</em> indicates whether the token is a literal string (one that does not change), a variable string (one that could have different values), an IPv4 or IPv6 address, a MAC address, an integer, a floating point number, or a timestamp.</p>

<p>A <em>FieldType</em> indicates the semantic meaning of the token. For example, a token could be a source IP address (%srcipv4%), or a user (%srcuser% or %dstuser%), an action (%action%) or a status (%status%).</p>

<h3 id="performance:196ac21fc7c80b3643c5060d84767136">Performance</h3>

<p>Most of the tools out there perform at several thousands messages per second (MPS) on a single machine using regex parsers. For <code>sequence</code>, we are able to achieve over 100,000 MPS with average message size of 140 bytes, using a single CPU core. <code>sequence</code> can also scale almost linearly (with a slight penalty due to communications overhead) as more cores are added.</p>

<p>The following performance benchmarks are run on a single 4-core (2.8Ghz i7) MacBook Pro. The first file is a
bunch of sshd logs, averaging 98 bytes per message. The second is a Cisco ASA log file, averaging 180 bytes per message. Last is a mix of ASA, sshd and sudo logs, averaging 136 bytes per message.</p>

<pre><code>  $ ./sequence bench parse -p ../../patterns/sshd.txt -i ../../data/sshd.all
  Parsed 212897 messages in 1.69 secs, ~ 126319.27 msgs/sec

  $ ./sequence bench parse -p ../../patterns/asa.txt -i ../../data/allasa.log
  Parsed 234815 messages in 2.89 secs, ~ 81323.41 msgs/sec

  $ ./sequence bench parse -d ../patterns -i ../data/asasshsudo.log
  Parsed 447745 messages in 4.47 secs, ~ 100159.65 msgs/sec
</code></pre>

<p>Performance can be improved by adding more cores:</p>

<pre><code>  GOMAXPROCS=2 ./sequence bench parse -p ../../patterns/sshd.txt -i ../../data/sshd.all -w 2
  Parsed 212897 messages in 1.00 secs, ~ 212711.83 msgs/sec

  $ GOMAXPROCS=2 ./sequence bench parse -p ../../patterns/asa.txt -i ../../data/allasa.log -w 2
  Parsed 234815 messages in 1.56 secs, ~ 150769.68 msgs/sec

  $ GOMAXPROCS=2 ./sequence bench parse -d ../patterns -i ../data/asasshsudo.log -w 2
  Parsed 447745 messages in 2.52 secs, ~ 177875.94 msgs/sec
</code></pre>

<p>One may ask, who can POSSIBLY use such performance? Many organizations that I know are generating between 50-100M messages per second (MPS), that&rsquo;s only 1,200 MPS. However, some larger organizations I know are generating 60GB of Bluecoat logs per day, <strong>8 years ago</strong>!! That&rsquo;s a good 3,000 MPS assuming an average of 250 bytes per message. Even if log rate grows at 15%, that&rsquo;s over 10,000 MPS today. This already exceeds the capability of some parsers.</p>

<p>To run through another example, <a href="http://www.covert.io/research-papers/security/Beehive%20-%20Large-Scale%20Log%20Analysis%20for%20Detecting%20Suspicious%20Activity%20in%20Enterprise%20Networks.pdf">at EMC, 1.4 billion log messages are generated daily on average, at a rate of one terabyte a day</a>. That&rsquo;s 16,200 messages per second, and about 714 bytes per message. These EMC numbers are from 2013, so they have most likely increased by now.</p>

<p>The <code>sequence</code> parser, with a single CPU core, can process about 270,000 MPS for messages averaging 98 bytes. Assuming the performance is linear compare to the message size (which is pretty close to the truth), we can parse 37,000 MPS for messages averaging 714 bytes. That&rsquo;s twice of what&rsquo;s needed for EMC, using a SINGLE CORE!</p>

<p>Obviously one can throw more hardware at solving the scale problem with the existing tools, but then again, why do that if you don&rsquo;t need to. Just because you have the hardware doesn&rsquo;t mean you should waste the money! Besides, there are much more interesting analytics problems your hardware can be used for than just tokenizing a message.</p>


							    <div style="text-align:center;margin-bottom:2em">
							    
							    &lt; <a href="http://sequencer.io/manual/introduction/">Introduction</a></li>
							    
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    &nbsp;
							    
							    <a href="http://sequencer.io/manual/scanner/">Scanner</a> &gt;</li>
							    
							    </div>

								<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'sequencer';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

							</section>
						</div>
					</div>
				</div>
			</section>

		
		<footer id="footer">
			<div class="container">
				<div class="row double">
					<div class="6u">
						<div class="row collapse-at-2">
							<div class="6u">
								<h3>Projects</h3>
								<ul class="alt">
									
									<li><a href="https://github.com/surgemq/surgemq">SurgeMQ</a></li>
									
									<li><a href="https://github.com/trustpath/sequence">Sequence</a></li>
									
									<li><a href="https://github.com/surge">Others Cool Projects</a></li>
									
								</ul>
							</div>
							<div class="6u">
								<h3>Sites</h3>
								<ul class="alt">
									
									<li><a href="http://surgemq.com">SurgeMQ Blog</a></li>
									
									<li><a href="http://zhen.org">Zen 3.1 Blog</a></li>
									
								</ul>
							</div>
						</div>
					</div>
					<div class="6u">
						<h2>Sequence</h2>
						<p>Sequence is a high performance sequential log scanner, analyzer and parser. It sequentially goes through a log message, parses out the meaningful parts, without the use regular expressions. It can parse over 100,000 messages per second without the need to separate parsing rules by log source type.</p>
						<ul class="icons">
							<li><a href="https://twitter.com/trustpath" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
							<li><a href="https://linkedin.com/in/zhenjl" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://github.com/trustpath/sequence" class="icon fa-github"><span class="label">Github</span></a></li>
						</ul>
					</div>
				</div>
				<ul class="copyright">
					<li>&copy; Dataence, LLC. All Rights Reserved.</li>
					<li>Built by <a href="http://gohugo.io">Hugo</a></li>
					<li>Design by <a href="http://templated.co">TEMPLATED</a></li>
					<li>Images by <a href="http://unsplash.com">Unsplash</a></li>
				</ul>
			</div>
		</footer>

	</body>
</html>
